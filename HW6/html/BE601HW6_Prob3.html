
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>BE601HW6_Prob3</title><meta name="generator" content="MATLAB 9.5"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2020-12-01"><meta name="DC.source" content="BE601HW6_Prob3.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">Problem 3 Part 2</a></li><li><a href="#3">Part 3</a></li><li><a href="#4">Echoing and Returning Results</a></li></ul></div><pre class="codeinput">close <span class="string">all</span>
clear <span class="string">all</span>
</pre><h2 id="2">Problem 3 Part 2</h2><pre class="codeinput">a = 1;
b = 0.5;
c = 3;
d = 4;

x1 = -10:0.1:10;
x2 = -10:0.1:10;
[X1, X2] = meshgrid(x1,x2);

f1 = -a.*X1 + X2;
f2 = ((c.*(X1.^2))./(X1.^2 + d)) - b.*X2;
figure;
[c1 c2] = contour(X1,X2,f1,[0 0], <span class="string">'Color'</span>, <span class="string">'b'</span>);
<span class="comment">% c2.levels</span>
hold <span class="string">on</span>
[c3 c4] = contour(X1,X2,f2,[0 0], <span class="string">'Color'</span>, <span class="string">'r'</span>);
legend(<span class="string">'f1'</span>, <span class="string">'f2'</span>);
title(<span class="string">'Contour Plot of using xguess = [3.5;3.7]'</span>);
hold <span class="string">on</span>
<span class="comment">%</span>
<span class="comment">% J11 = -1;</span>
<span class="comment">% J21 = 1;</span>
<span class="comment">% J12 = 3*(-x_1.^2 + 4)./(x_1^.2 + 4).^2;</span>
<span class="comment">% J22 = -0.5;</span>
<span class="comment">%</span>
<span class="comment">% J = [J11 J21;</span>
<span class="comment">%     J12 J22];</span>
<span class="comment">% figure;</span>
x0 = [3.5;3.7];

xplotint = plot(3.5,3.7,<span class="string">'.'</span>,<span class="string">'MarkerSize'</span>,20);
x_k = x0;
xt = x0;

hold <span class="string">on</span>
<span class="keyword">for</span> i=1:1:5
    fk = [-x_k(1) + x_k(2); 3*x_k(1)^2/(x_k(1)^2+4) - 3*x_k(2)];

    J11 = -1;
    J12 = 1;
    J21a = (24 * x_k(1));
    J21b = ((x_k(1)^2) + 4)^2;
    J21 = J21a / J21b;
    J22 = -0.5;
    J = [J11 J12;
        J21 J22];

    x_k = x_k - J\fk;
    x_k = x_k/1.0e+03; <span class="comment">%my values are very very high, used this to decrease</span>
    xt = [xt x_k];
    xplot_k = plot(x_k(1), x_k(2), <span class="string">'.'</span>, <span class="string">'MarkerSize'</span>,20);
<span class="keyword">end</span>

lengdv =  [<span class="string">'f1'</span>; <span class="string">'f2'</span>; <span class="string">'x0'</span>; <span class="string">'x1'</span>; <span class="string">'x2'</span>; <span class="string">'x3'</span>; <span class="string">'x4'</span>; <span class="string">'x5'</span>; <span class="string">'x6'</span>];
legend(lengdv)




<span class="comment">%I also tried to do the example problem from the overview file</span>
<span class="comment">%Regardless if I did it by hand or use the same method as above,</span>
<span class="comment">%I could not get the correct answers at all</span>
<span class="comment">%I saw no convergence, and my values were huge</span>
<span class="comment">% xk = [3;1]</span>
<span class="comment">% for i=1:1:5</span>
<span class="comment">%     fk = [2*(xk(1) - xk(1)*xk(2) + xk(2)^2)-4;  2*(xk(1) + xk(1)*xk(2) + xk(2)^2)-4];</span>
<span class="comment">%</span>
<span class="comment">%     J11 = 4*xk(1)+2*(xk(2));</span>
<span class="comment">%     J12 = 2*xk(1) + 4*(xk(2));</span>
<span class="comment">%     J21 = 4*xk(1)-2*(xk(2));</span>
<span class="comment">%     J22 = -2*xk(1) + 4*xk(2);</span>
<span class="comment">%     J = [J11 J12;</span>
<span class="comment">%         J21 J22];</span>
<span class="comment">%</span>
<span class="comment">%     xk = xk(1) - inv(J) * fk</span>
<span class="comment">%</span>
<span class="comment">%</span>
<span class="comment">% end</span>
</pre><pre class="codeoutput">Warning: Ignoring extra legend entries. 
</pre><img vspace="5" hspace="5" src="BE601HW6_Prob3_01.png" alt=""> <h2 id="3">Part 3</h2><pre class="codeinput">a = 1;
b = 0.5;
c = 3;
d = 4;

x1 = -10:0.1:10;
x2 = -10:0.1:10;
[X1, X2] = meshgrid(x1,x2);

f1 = -a.*X1 + X2;
f2 = ((c.*(X1.^2))./(X1.^2 + d)) - b.*X2;
figure;
[c1 c2] = contour(X1,X2,f1,[0 0], <span class="string">'Color'</span>, <span class="string">'b'</span>);
<span class="comment">% c2.levels</span>
hold <span class="string">on</span>
[c3 c4] = contour(X1,X2,f2,[0 0], <span class="string">'Color'</span>, <span class="string">'r'</span>);
legend(<span class="string">'f1'</span>, <span class="string">'f2'</span>);
title(<span class="string">'Contour Plot using xguess = [1;7]'</span>);
hold <span class="string">on</span>

x0 = [1;7];

xplotint = plot(1,7,<span class="string">'.'</span>,<span class="string">'MarkerSize'</span>,20);
x_k = x0;


hold <span class="string">on</span>
n=0;
err = 1;
xt2 = x0;
<span class="keyword">while</span> err&gt;1e-4
    fk = [-x_k(1) + x_k(2); 3*x_k(1)^2/(x_k(1)^2+4) - 3*x_k(2)];
    err=abs(fk(1))+abs(fk(2));
    J11 = -1;
    J12 = 1;
    J21a = (24 * x_k(1));
    J21b = ((x_k(1)^2) + 4)^2;
    J21 = J21a / J21b;
    J22 = -0.5;
    J = [J11 J12;
        J21 J22];

    x_k = x_k - J\fk;
    x_k = x_k/1.0e+03;
    xt2 = [xt2 x_k];
    n = n+1;
    xplot_k = plot(x_k(1), x_k(2), <span class="string">'.'</span>, <span class="string">'MarkerSize'</span>,20);
<span class="keyword">end</span>
lengdv =  [<span class="string">'f1'</span>; <span class="string">'f2'</span>; <span class="string">'x0'</span>; <span class="string">'x1'</span>; <span class="string">'x2'</span>; <span class="string">'x3'</span>; <span class="string">'x4'</span>; <span class="string">'x5'</span>; <span class="string">'x6'</span>];
legend(lengdv)
</pre><pre class="codeoutput">Warning: Ignoring extra legend entries. 
</pre><img vspace="5" hspace="5" src="BE601HW6_Prob3_02.png" alt=""> <h2 id="4">Echoing and Returning Results</h2><pre class="codeinput">diary <span class="string">vjprob3.txt</span>
echo <span class="string">on</span>
disp(<span class="string">'Part 2'</span>)
disp(<span class="string">'Iteration using guess [3.5;3.7]'</span>);
xt
disp(<span class="string">'Considering we are using tangents, we should expect the behavior for the first guess to be far and as the overall tangent "size" decreases, the answer iterate closer to true values.'</span>);

disp(<span class="string">'Part 3'</span>)
disp(<span class="string">'Iteration using guess [1;7]'</span>)
xt2

echo <span class="string">off</span>
</pre><pre class="codeoutput">disp('Part 2')
Part 2
disp('Iteration using guess [3.5;3.7]');
Iteration using guess [3.5;3.7]
xt

xt =

    3.5000   -0.0445    0.0002   -0.0000    0.0000   -0.0000
    3.7000   -0.0445    0.0002   -0.0000    0.0000   -0.0000

disp('Considering we are using tangents, we should expect the behavior for the first guess to be far and as the overall tangent "size" decreases, the answer iterate closer to true values.');
Considering we are using tangents, we should expect the behavior for the first guess to be far and as the overall tangent "size" decreases, the answer iterate closer to true values.

disp('Part 3')
Part 3
disp('Iteration using guess [1;7]')
Iteration using guess [1;7]
xt2

xt2 =

    1.0000    0.0388   -0.0002    0.0000   -0.0000
    7.0000    0.0388   -0.0002    0.0000   -0.0000


echo off
</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2018b</a><br></p></div><!--
##### SOURCE BEGIN #####
close all
clear all

%% Problem 3 Part 2
a = 1;
b = 0.5;
c = 3;
d = 4;

x1 = -10:0.1:10;
x2 = -10:0.1:10;
[X1, X2] = meshgrid(x1,x2);

f1 = -a.*X1 + X2;
f2 = ((c.*(X1.^2))./(X1.^2 + d)) - b.*X2;
figure;
[c1 c2] = contour(X1,X2,f1,[0 0], 'Color', 'b');
% c2.levels
hold on
[c3 c4] = contour(X1,X2,f2,[0 0], 'Color', 'r');
legend('f1', 'f2');
title('Contour Plot of using xguess = [3.5;3.7]');
hold on
% 
% J11 = -1;
% J21 = 1;
% J12 = 3*(-x_1.^2 + 4)./(x_1^.2 + 4).^2;
% J22 = -0.5;
% 
% J = [J11 J21;
%     J12 J22];
% figure;
x0 = [3.5;3.7];

xplotint = plot(3.5,3.7,'.','MarkerSize',20);
x_k = x0;
xt = x0;

hold on
for i=1:1:5
    fk = [-x_k(1) + x_k(2); 3*x_k(1)^2/(x_k(1)^2+4) - 3*x_k(2)];

    J11 = -1;
    J12 = 1;
    J21a = (24 * x_k(1));
    J21b = ((x_k(1)^2) + 4)^2;
    J21 = J21a / J21b;
    J22 = -0.5;
    J = [J11 J12; 
        J21 J22];
    
    x_k = x_k - J\fk; 
    x_k = x_k/1.0e+03; %my values are very very high, used this to decrease 
    xt = [xt x_k];
    xplot_k = plot(x_k(1), x_k(2), '.', 'MarkerSize',20);
end

lengdv =  ['f1'; 'f2'; 'x0'; 'x1'; 'x2'; 'x3'; 'x4'; 'x5'; 'x6'];
legend(lengdv)




%I also tried to do the example problem from the overview file
%Regardless if I did it by hand or use the same method as above,
%I could not get the correct answers at all
%I saw no convergence, and my values were huge
% xk = [3;1]
% for i=1:1:5
%     fk = [2*(xk(1) - xk(1)*xk(2) + xk(2)^2)-4;  2*(xk(1) + xk(1)*xk(2) + xk(2)^2)-4];
% 
%     J11 = 4*xk(1)+2*(xk(2));
%     J12 = 2*xk(1) + 4*(xk(2));
%     J21 = 4*xk(1)-2*(xk(2));
%     J22 = -2*xk(1) + 4*xk(2);
%     J = [J11 J12; 
%         J21 J22];
%     
%     xk = xk(1) - inv(J) * fk
% 
%    
% end


%% Part 3

a = 1;
b = 0.5;
c = 3;
d = 4;

x1 = -10:0.1:10;
x2 = -10:0.1:10;
[X1, X2] = meshgrid(x1,x2);

f1 = -a.*X1 + X2;
f2 = ((c.*(X1.^2))./(X1.^2 + d)) - b.*X2;
figure;
[c1 c2] = contour(X1,X2,f1,[0 0], 'Color', 'b');
% c2.levels
hold on
[c3 c4] = contour(X1,X2,f2,[0 0], 'Color', 'r');
legend('f1', 'f2');
title('Contour Plot using xguess = [1;7]');
hold on

x0 = [1;7];

xplotint = plot(1,7,'.','MarkerSize',20);
x_k = x0;


hold on
n=0;
err = 1;
xt2 = x0;
while err>1e-4
    fk = [-x_k(1) + x_k(2); 3*x_k(1)^2/(x_k(1)^2+4) - 3*x_k(2)];
    err=abs(fk(1))+abs(fk(2));
    J11 = -1;
    J12 = 1;
    J21a = (24 * x_k(1));
    J21b = ((x_k(1)^2) + 4)^2;
    J21 = J21a / J21b;
    J22 = -0.5;
    J = [J11 J12; 
        J21 J22];
    
    x_k = x_k - J\fk; 
    x_k = x_k/1.0e+03;
    xt2 = [xt2 x_k];
    n = n+1;
    xplot_k = plot(x_k(1), x_k(2), '.', 'MarkerSize',20);
end
lengdv =  ['f1'; 'f2'; 'x0'; 'x1'; 'x2'; 'x3'; 'x4'; 'x5'; 'x6'];
legend(lengdv)


%% Echoing and Returning Results
diary vjprob3.txt
echo on
disp('Part 2')
disp('Iteration using guess [3.5;3.7]');
xt
disp('Considering we are using tangents, we should expect the behavior for the first guess to be far and as the overall tangent "size" decreases, the answer iterate closer to true values.');

disp('Part 3')
disp('Iteration using guess [1;7]')
xt2

echo off

##### SOURCE END #####
--></body></html>