%% Part A
clc
clear all
close all

G = [4,-1,0,0,0,-1,0,0,0,0,0,0,0,0,0;
    -1,4,-1,0,0,0,-1,0,0,0,0,0,0,0,0;
    0,-1,4,-1,0,0,0,-1,0,0,0,0,0,0,0;
    0,0,-1,4,-1,0,0,0,-1,0,0,0,0,0,0;
    0,0,0,-1,4,0,0,0,0,-1,0,0,0,0,0;
    -1,0,0,0,0,4,-1,0,0,0,-1,0,0,0,0;
    0,-1,0,0,0,-1,4,-1,0,0,0,-1,0,0,0;
    0,0,-1,0,0,0,-1,4,-1,0,0,0,-1,0,0;
    0,0,0,-1,0,0,0,-1,4,-1,0,0,0,-1,0;
    0,0,0,0,-1,0,0,0,-1,4,0,0,0,0,-1;
    0,0,0,0,0,-1,0,0,0,0,4,-1,0,0,0;
    0,0,0,0,0,0,-1,0,0,0,-1,4,-1,0,0;
    0,0,0,0,0,0,0,-1,0,0,0,-1,4,-1,0;
    0,0,0,0,0,0,0,0,-1,0,0,0,-1,4,-1;
    0,0,0,0,0,0,0,0,0,-1,0,0,0,-1,4];

b = [12 0 0 0 0 12 0 0 0 0 12 0 0 0 0]';

f0 = figure('Name', 'Spy(G)');
t = title('Spy(G)'); %not sure why this isn't working
spy(G)

[L, U, P] = lu(G);

f1 = figure('Name', 'Spy(L)');
title('Spy(L)')
spy(L)

f2 = figure('Name', 'Spy(U)');
title('Spy(U)')
spy(U)

f3 = figure('Name', 'Spy(P)');
title('Spy(P)')
spy(P)

f5 = figure('Name', 'Subplot Comparison');
subplot(2, 2, 1);
spy(G)
subplot(2, 2, 2);
spy(L)
subplot(2, 2, 3);
spy(U)
subplot(2, 2, 4);
spy(P)

v = G\b

V_report = reshape(v, [5, 3]).' 

%% Part B

partB_G = [4,-1,0,0,0,-1,0,0,0,0,0,0,0,0,0;
    -1,4,-1,0,0,0,-1,0,0,0,0,0,0,0,0;
    0,-1,4,-1,0,0,0,-1,0,0,0,0,0,0,0;
    0,0,-1,4,-1,0,0,0,-1,0,0,0,0,0,0;
    0,0,0,-1,4,0,0,0,0,-1,0,0,0,0,0;
    -1,0,0,0,0,4,-1,0,0,0,-1,0,0,0,0;
    0,-1,0,0,0,-1,3,-1,0,0,0,0,0,0,0;
    0,0,-1,0,0,0,-1,4,-1,0,0,0,-1,0,0;
    0,0,0,-1,0,0,0,-1,3,-1,0,0,0,0,0;
    0,0,0,0,-1,0,0,0,-1,4,0,0,0,0,-1;
    0,0,0,0,0,-1,0,0,0,0,3,-1,0,0,0;
    0,0,0,0,0,0,0,0,0,0,-1,2,-1,0,0;
    0,0,0,0,0,0,0,-1,0,0,0,-1,3,-1,0;
    0,0,0,0,0,0,0,0,0,0,0,0,-1,2,-1;
    0,0,0,0,0,0,0,0,0,-1,0,0,0,-1,3];
b = [12 0 0 0 0 12 0 0 0 0 12 0 0 0 0]';

v_new = partB_G\b

V_report_new = reshape(v_new, [5, 3]).' 